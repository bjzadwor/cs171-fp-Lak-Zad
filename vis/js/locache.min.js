(function(){function c(a){a&&a.storage&&(this.storage=a.storage);this.async.set=g(this.async.set,this);this.async.get=g(this.async.get,this)}var e=this,g=function(a,b){return function(){return a.apply(b,arguments)}};c.prototype.VERSION="0.4.2";var h=c.prototype,k;try{e.localStorage.setItem("___locache___","___locache___"),e.localStorage.getItem("___locache___"),e.localStorage.removeItem("___locache___"),k=!0}catch(q){k=!1}var n=h.supportsLocalStorage=k,h=c.prototype,f;try{e.sessionStorage.setItem("___locache___",
"___locache___"),e.sessionStorage.getItem("___locache___"),e.sessionStorage.removeItem("___locache___"),f=!0}catch(r){f=!1}var p=h.supportsSessionStorage=f,l=c.prototype.supportsNativeJSON=!!e.JSON;c.prototype.supportsPostMessage=!!window.postMessage;var m=c.prototype._defer=function(){function a(a){this.fn=a}var b=[],d;e.addEventListener?d=e.addEventListener:e.attachEvent&&(d=e.attachEvent);d("message",function(a){if(a.source===e&&"function-defer-message"===a.data&&(a.stopPropagation(),0!==b.length))return b.shift()(),
!1},!0);a.prototype.defer=function(){this.resultValue=this.fn();this.hasOwnProperty("finishedFunction")&&this.finishedFunction(this.resultValue)};a.prototype.hasFinished=function(){return this.hasOwnProperty("resultValue")};a.prototype.finished=function(a){this.finishedFunction=a;this.hasFinished()&&this.finishedFunction(this.resultValue);return this};return function(d){d=new a(d);b.push(g(d.defer,d));e.postMessage("function-defer-message","*");return d}}();c.prototype.cachePrefix="___locache___";
c.prototype.expirePrefix="___locacheExpire___";c.prototype.backends={local:{set:function(a,b){return e.localStorage.setItem(a,b)},get:function(a){return e.localStorage.getItem(a)},remove:function(a){return e.localStorage.removeItem(a)},length:function(a){return e.localStorage.length},key:function(a){if(!(0>a||a>=this.length()))return e.localStorage.key(a)},enabled:function(){return l&&n}},session:{set:function(a,b){return e.sessionStorage.setItem(a,b)},get:function(a){return e.sessionStorage.getItem(a)},
remove:function(a){return e.sessionStorage.removeItem(a)},length:function(a){return e.sessionStorage.length},key:function(a){if(!(0>a||a>=this.length()))return e.sessionStorage.key(a)},enabled:function(){return l&&p}}};c.prototype.storage=c.prototype.backends.local;c.prototype.key=function(a){return this.cachePrefix+a};c.prototype.expirekey=function(a){return this.expirePrefix+a};c.prototype.hasExpired=function(a){a=this.expirekey(a);return(a=parseInt(this.storage.get(a),10))&&a<(new Date).getTime()?
!0:!1};c.prototype.set=function(a,b,d){if(this.storage.enabled()&&a){var c=this.expirekey(a);a=this.key(a);d?(d*=1E3,this.storage.set(c,(new Date).getTime()+d)):this.storage.remove(c);b=JSON.stringify(b);return this.storage.set(a,b)}};c.prototype.get=function(a){if(!this.storage.enabled()||!a)return null;if(this.hasExpired(a))return this.remove(this.key(a)),null;a=this.key(a);if(a=this.storage.get(a))try{return JSON.parse(a)}catch(b){return null}return a};c.prototype.async={set:function(a,b,d){return m(g(function(){return this.set(a,
b,d)},this))},get:function(a){return m(g(function(){return this.get(a)},this))}};c.prototype.remove=function(a){if(this.storage.enabled()){var b=this.expirekey(a);a=this.key(a);this.storage.remove(b);this.storage.remove(a)}};c.prototype.incr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b++;this.set(a,b);return b}};c.prototype.decr=function(a){if(this.storage.enabled()){var b=parseInt(this.get(a),10);b||(b=0);b--;this.set(a,b);return b}};c.prototype.setMany=function(a,
b){if(this.storage.enabled())for(var d in a)a.hasOwnProperty(d)&&this.set(d,a[d],b)};c.prototype.getMany=function(a){for(var b={},d=0;d<a.length;d++)this.storage.enabled()?b[a[d]]=this.get(a[d]):b[a[d]]=null;return b};c.prototype.getManyValues=function(a){for(var b=[],d=0;d<a.length;d++)this.storage.enabled()?b.push(this.get(a[d])):b.push(null);return b};c.prototype.removeMany=function(a){if(this.storage.enabled())for(var b=0;b<a.length;b++)this.remove(a[b])};c.prototype.flush=function(){if(this.storage.enabled())for(var a=
this.storage.length(),b=this.cachePrefix,a=a-1;0<=a;a--){var d=this.storage.key(a);d&&0===d.indexOf(b)&&(d=d.substring(b.length,d.length),this.remove(d))}};c.prototype.length=function(){if(!this.storage.enabled())return 0;for(var a=0,b=this.storage.length(),d=this.cachePrefix,c=0;c<b;c++)0===this.storage.key(c).indexOf(d)&&a++;return a};c.prototype.keys=function(){if(!this.storage.enabled())return[];for(var a=[],b=this.storage.length(),d=this.cachePrefix,c=0;c<b;c++){var e=this.storage.key(c);0===
e.indexOf(d)&&(e=e.substring(d.length,e.length),a.push(e))}return a};c.prototype.cleanup=function(){if(this.storage.enabled())for(var a=this.storage.length(),b=this.cachePrefix,d=0;d<a;d++){var c=this.storage.key(d);c&&0===c.indexOf(b)&&(c=c.substring(b.length,c.length),this.hasExpired(c)&&this.remove(c))}};c.prototype.createCache=function(a){return new c(a)};f=new c;f.session=new c({storage:f.backends.session});e.locache=f}).call(this);
